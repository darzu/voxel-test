namespace SpriteKind {
    export const Background = SpriteKind.create()
}
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    if (scene.backgroundImage().getPixel(PlayerSprite.x, PlayerSprite.bottom - 0) == 14) {
        PlayerSprite.vy = -100
    }
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (projectile) {
        projectile.destroy()
    }
    projectile = sprites.createProjectileFromSprite(img`
        . . . . . . . . 
        . 5 5 5 5 5 . . 
        5 5 5 5 5 5 5 . 
        5 5 5 5 5 5 5 . 
        5 5 5 5 5 5 5 . 
        5 5 5 5 5 5 5 . 
        5 5 5 5 5 5 5 . 
        . 5 5 5 5 5 . . 
        `, PlayerSprite, 50, 0)
    projectile.left = PlayerSprite.right + 4
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Background, function (sprite, otherSprite) {
    ricochet(sprite)
    destroyBlocks(sprite)
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Player, function (sprite, otherSprite) {
    sprite.destroy()
})
function ricochet (sprite: Sprite) {
    sprite.vx = 0 - sprite.vx
    sprite.ax = 0 - sprite.ax
}
function updateBackground () {
    background.setImage(scene.backgroundImage().clone())
}
function destroyBlocks (collider: Sprite) {
    for (let x = 0; x <= collider.width; x++) {
        for (let y = 0; y <= collider.height; y++) {
            if (collider.image.getPixel(x, y) != 0) {
                scene.backgroundImage().setPixel(collider.left + x, collider.top + y, 0)
            }
        }
    }
}
let projectile: Sprite = null
let background: Sprite = null
let PlayerSprite: Sprite = null
scene.setBackgroundColor(9)
PlayerSprite = sprites.create(img`
    . 1 1 1 1 
    d d d d d 
    d d d d d 
    d d f d f 
    d d d d d 
    . d b b . 
    7 8 8 8 . 
    7 8 7 8 . 
    7 8 8 8 . 
    . 8 . 8 . 
    `, SpriteKind.Player)
PlayerSprite.ay = 300
PlayerSprite.setFlag(SpriteFlag.StayInScreen, true)
controller.moveSprite(PlayerSprite, 50, 0)
scene.setBackgroundImage(img`
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ..................................................................................................................................eeeeee........................
    .............................................................................................................................eeeeeeeeeeee.......................
    ............................................................................................................................eeeeeeeeeeeee.......................
    ..........................................................................................................................eeeeeeeeeeeeeeee......................
    .........................................................................................................................eeeeeeeeeeeeeeeee......................
    ........................................................................................................................eeeeeeeeeeeeeeeeeee.....................
    ........................................................................................................................eeeeeeeeeeeeeeeeeee.....................
    .......................................................................................................................eeeeeeeeeeeeeeeeeeeee....................
    ......................................................................................................................eeeeeeeeeeeeeeeeeeeeee....................
    .....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeee...................
    .....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeee..................
    .....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeee..................
    .....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeee..................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeee.................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeee.................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeee.................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeee................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeee................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeee................
    ....................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ...................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ...................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ...................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ...................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ...................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............
    ..................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    ..................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    ..................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    ..................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    .................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    .................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    ................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..............
    ................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ................................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ...............................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ...............................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.............
    ..............................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee............
    ..............................................................................................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee............
    ..............................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.......................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee............
    ..........................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.................................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee............
    ........................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee........................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee............
    ...................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee...........
    ................eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..........eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee...........
    ..............eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee...........
    ..........eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee...........
    ......eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee...........
    ...eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee..........
    .eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
    `)
background = sprites.create(img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `, SpriteKind.Background)
background.left = 0
background.top = 10
background.setFlag(SpriteFlag.Invisible, true)
game.onUpdate(function () {
    if (scene.backgroundImage().getPixel(PlayerSprite.x, PlayerSprite.bottom) == 14) {
        PlayerSprite.vy = 0
    }
    if (scene.backgroundImage().getPixel(PlayerSprite.x, PlayerSprite.bottom - 1) == 14) {
        PlayerSprite.y += -1
        PlayerSprite.vy = 0
    }
    if (scene.backgroundImage().getPixel(PlayerSprite.right, PlayerSprite.y) == 14) {
        PlayerSprite.vy = 0
        PlayerSprite.x += -1
    }
    if (scene.backgroundImage().getPixel(PlayerSprite.left, PlayerSprite.y) == 14) {
        PlayerSprite.vy = 0
        PlayerSprite.x += 1
    }
})
game.onUpdateInterval(100, function () {
    updateBackground()
})
